# ğŸ“Œ DÃ©finition de la version de l'API Kubernetes pour les objets Deployment (ici v1 pour les dÃ©ploiements)
apiVersion: apps/v1

# ğŸ“Œ Type de l'objet Kubernetes, ici un dÃ©ploiement (Deployment)
kind: Deployment

# ğŸ“Œ MÃ©tadonnÃ©es liÃ©es au dÃ©ploiement
metadata:
  # ğŸ·ï¸ Nom du dÃ©ploiement. Il est utilisÃ© pour identifier ce Deployment dans Kubernetes
  name: client-depl

# ğŸ“Œ SpÃ©cifications du dÃ©ploiement
spec:
  # ğŸ”„ Nombre de rÃ©plicas (copies) du pod que Kubernetes doit maintenir en fonctionnement
  replicas: 1  # Ici, un seul pod est instanciÃ©

  # ğŸ¯ SÃ©lecteur qui permet Ã  Kubernetes dâ€™associer ce dÃ©ploiement aux pods correspondants
  selector:
    # ğŸ·ï¸ CritÃ¨re de sÃ©lection basÃ© sur un label spÃ©cifique (app: client)
    matchLabels:
      app: client  # Ce label associe les pods au dÃ©ploiement

  # ğŸ“Œ ModÃ¨le de pod utilisÃ© par le dÃ©ploiement pour crÃ©er les instances de pods
  template:
    metadata:
      # ğŸ·ï¸ Labels dÃ©finis pour le pod, qui doivent correspondre au sÃ©lecteur ci-dessus
      labels:
        app: client  # Label qui lie le pod au Deployment

    spec:
      # ğŸ“Œ DÃ©finition des containers qui seront exÃ©cutÃ©s dans le pod
      containers:
        - name: client  # Nom du conteneur, utilisÃ© pour l'identification interne
          image: elbraco/client  # ğŸ³ Image Docker utilisÃ©e pour ce conteneur (doit Ãªtre disponible sur un registre)

---

# ğŸ“Œ DÃ©finition d'un Service Kubernetes pour exposer le pod client
apiVersion: v1
kind: Service
metadata:
  name: client-srv  # ğŸ·ï¸ Nom du service, utilisÃ© pour rÃ©fÃ©rencer ce service dans Kubernetes

spec:
  # ğŸ¯ SÃ©lecteur permettant dâ€™associer ce service aux pods avec le label "app: client"
  selector:
    app: client  # Associe ce service aux pods qui portent le label "app: client"

  # ğŸ“Œ DÃ©finition des ports sur lesquels le service sera accessible
  ports:
    - name: client  # Nom du port, utile pour l'identification interne
      protocol: TCP  # ğŸ“¡ Protocole utilisÃ© (TCP, standard pour HTTP)
      port: 3000  # ğŸ“Œ Port exposÃ© par le service (accÃ¨s au sein du cluster)
      targetPort: 3000  # ğŸ¯ Port interne du pod cible (doit correspondre au port utilisÃ© par lâ€™application)

# ğŸ“ DÃ©brief gÃ©nÃ©ral :
# - Ce fichier dÃ©finit un **Deployment** et un **Service** pour lâ€™application `client`.
# - **Deployment** :
#   - Il crÃ©e un seul pod (`replicas: 1`) basÃ© sur lâ€™image `elbraco/client`.
#   - Il associe ce pod avec le label `app: client` pour pouvoir le retrouver facilement.
# - **Service** :
#   - Il expose le pod `client` en interne dans Kubernetes avec le nom `client-srv`.
#   - Il route le trafic vers le port 3000 du pod.
# - Cette configuration permet au pod dâ€™Ãªtre dÃ©couvert par dâ€™autres services dans le cluster Kubernetes.

# ğŸš€ AmÃ©liorations possibles :
# - Ajouter un `resources` limitant CPU/mÃ©moire dans le container pour Ã©viter la surcharge.
# - Ajouter un `livenessProbe` et `readinessProbe` pour assurer la stabilitÃ© du pod.
# - Augmenter le nombre de `replicas` pour une meilleure disponibilitÃ©.
# - Ajouter un `type: ClusterIP | NodePort | LoadBalancer` au Service selon les besoins.
